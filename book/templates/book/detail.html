{% extends 'home/base.html' %}
{% block body %}
<body class="book-detail">
{% include 'library/library-header.html' %}
<div class="model-back">
    <div class="model">
        <!-- <img src="/static/LOGO8.png" alt="" class="popup-img"> -->
        <!-- <h4 class="popup-head">Be The Member Of Amazing Wise Club</h4> -->
        <h4 class="popup-head">Login To Wise Club</h4>
        <a href="#" class="no close-svg"><img src="/static/close.svg" alt="" class="close"></a>
        <form action="{% url 'book:detail' slug=book.slug%}" class="form" method="POST">
            {% csrf_token %}
            <div class="form-group">
                <input name="name" type="text" placeholder="Username" id="name" required class="form-input lib-login-username" autocomplete="off">
                <label for="name" class="label">Username</label>
            </div>
            <div class="form-group last-form-popup">
                <input name="password" type="password" placeholder="Password" id="password" required class="form-input" autocomplete="off">
                <label for="password" class="label">Password</label>
            </div>
            {% if error %}
            <div class="error-popup"><img src="/static/error_icon.png" alt="!"><span>Incorrect username or password</span></div>
            {%endif%}
            <div class="btn-box">
                <button class="btn-fire" id="btn5">Login &rarr;</button>
            </div>
        </form>
    </div>
</div>
<main style="padding: 110px 15px;position: absolute;top: 0px;box-sizing: border-box">
    <div class="layout__detail">
        <div class="detail-card">
            <div class="information">
                <img class="layout__item" src={{ book.image }} alt="IMAGE">
                <div class="text-box">
                    <h3 class="text-box__heading--name"><span class="span__name">{{book.title}}</span></h3>
                    <h3 class="by">By</h3>
                    <h3 class="text-box__heading--author"><span class="span__author">
                        {% for author in book.author.all %}
                            <a href="{% url 'author:author' slug=author.slug %}" class="btn-rotate">{{author}}</a>&nbsp;
                        {% endfor %}</span></h3>
                    <div class="genre">
                        {% for genre in book.genre.all %}
                            <a href="{% url 'library:genre' slug=genre.slug %}" class="btn-grow"><div class="genre-box">
                                <span class="genre-name">{{genre}}</span>
                            </div></a>
                        {% endfor %}
                    </div>
                </div>
                <!-- <div style="clear: both"></div> -->
            </div>
            <div class="summary u-margin-top-medium">
                <h3>Summary</h3>
                <div class="text">
                    <span class="span__text">{{book.description|safe}}</span>
                </div>
            </div>
        <div class="comment-box" style="position: relative">
            <h3 class="comment-box-heading">Wise Community Reviews</h3>
            <form action="{% url 'book:detail' slug=book.slug %}" method="POST" class="comment-form">
                {% csrf_token %}
                <input name="text" type="text" placeholder="Write a review...">
                <button class="btn-comment" type="submit">POST</button>
            </form>
        </div>
        {% for comment in comments %}
        <div class="previous-comment">
            <img src={{comment.user.image.url}} alt="">
            <div class="previous-comment-text-box">
                <span class="previous-comment-username">{{comment.user.username}}</span>
                <span class="previous-comment-text">{{comment.text}}</span>
            </div>
        </div>
        {% endfor %}
            {% if similar_books %}
            <h4 class="detail-similar-books-heading">Similar Books</h4>
            {% endif %}
        <div class="flex_similar">
        {% for book in similar_books %}
            <a href="{% url  'book:detail' slug=book.slug%}">
            <div class="card">
                <img class="card__image" src={{book.image}} alt="IMAGE">
                <div class="details">
                    <div class="card__name"><span class="span__name">{{book.title}}</span></div>
                    <div class="card__author"><span class="span__author">{%for main_author in book.author.all|slice:":1"%}
                        - {{main_author}}
                        {% endfor %}</span></div>
                </div>
            </div>
            </a>
        {% endfor %}
        </div>
        </div>
    </div>
</main>
{% include 'user/login_base.html' %}
<script>
<!--        document.querySelector('.comment-form').addEventListener("submit", setScrollPos);-->
<!--        function setScrollPos(){-->
<!--            localStorage.setItem('scrollPos', $(window).scrollTop());-->
<!--        }-->
<!--        $(window).on("load", winLoad)-->
<!--        function winLoad(){-->
<!--            console.log(localStorage.getItem('scrollPos'));-->
<!--            $(window).scrollTop(localStorage.getItem('scrollPos', 0));-->
<!--            console.log($(window).scrollTop())-->
<!--        }-->
<!--</script>-->
</body>
{% endblock %}
